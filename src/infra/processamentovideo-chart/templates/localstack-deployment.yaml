apiVersion: apps/v1
kind: Deployment
metadata:
    name: localstack
    labels:
        app: localstack
spec:
    replicas: 1
    selector:
        matchLabels:
            app: localstack
    template:
        metadata:
            labels:
                app: localstack
        spec:
            containers:
              - name: localstack
                image: localstack/localstack:latest
                ports:
                  - containerPort: 4566 # Porta que o LocalStack escuta
                  - containerPort: 4510 # Porta para Lambda (se necessário)
                  - containerPort: 4511 # Porta para outros serviços Lambda (se necessário)
                env:
                  - name: DOCKER_HOST
                    value: "unix:///var/run/docker.sock"
                volumeMounts:
                  - name: docker-socket
                    mountPath: /var/run/docker.sock
            volumes:
              - name: docker-socket
                hostPath:
                    path: /var/run/docker.sock
                    type: Socket
